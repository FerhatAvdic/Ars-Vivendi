<div class="gray-wrapper">
    <div class="container">
        <div class="box-members">
            <div class="text-center" ng-show="membersLoading">
                <img src="img/spin.gif" />
            </div>
            <div class="row" ng-hide="membersLoading">
                <div class="col-md-3">
                    <div class="member-filters" ng-class="{'member-filters-visible':filterActive}">
                        <div class="member-filters-inner">
                            <div class="text-center"><button class="btn btn-default" style="margin-bottom: 20px;" ng-click="filterActive=false;">Zatvori</button></div>
                            <div class="panel panel-default">
                                <div class="members-filter-toggle" ng-click="isCollapsed.panel2 = !isCollapsed.panel2">Filteriši po Kolonama</div>
                                <div class="members-filter" uib-collapse="isCollapsed.panel2">
                                    <!--<div class="form-group">
                    <select class="form-control" ng-model="pageSize" ng-options="pageSizeOption.value as pageSizeOption.name for pageSizeOption in pageSizeOptions"></select>
                </div>-->
                                    <div class="form-group">
                                        <label>Ime:</label>
                                        <input type="text" class="form-control" ng-model="columnFilters.firstName">
                                    </div>
                                    <div class="form-group">
                                        <label>Prezime:</label>
                                        <input type="text" class="form-control" ng-model="columnFilters.lastName">
                                    </div>
                                    <div class="form-group">
                                        <label>Email:</label>
                                        <input type="text" class="form-control" ng-model="columnFilters.email">
                                    </div>
                                    <div class="form-group">
                                        <label>Telefon:</label>
                                        <input type="text" class="form-control" ng-model="columnFilters.phoneNumber">
                                    </div>
                                    <div class="form-group">
                                        <label>Adresa:</label>
                                        <input type="text" class="form-control" ng-model="columnFilters.address">
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-default" ng-repeat="category in interestCategories">
                                <div class="members-filter-toggle">{{category.categoryName}}</div>
                                <div class="members-filter">
                                    <ul>
                                        <li class="checkbox" ng-repeat="subCategory in subCategories" ng-if="subCategory.categoryId===category.id">
                                            <label><input type="checkbox" value="" ng-model="subCategory.checked" ng-change="updateInterests(subCategory.name)">{{subCategory.name}}</label>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-12">
                    <div class="box-members-list">
                        <p class="members-table-title">Članovi</p>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="members-table-options text-right" ng-hide="showCheckboxes">
                                    <button class="btn btn-default" ng-click="filterActive=!filterActive;"><i class="fa fa-filter" aria-hidden="true"></i> Filteri</button>
                                    <button class="btn btn-primary" ng-click="prepareEmail()"><i class="fa fa-envelope-o" aria-hidden="true"></i> Priprema emaila</button>
                                    <button class="btn btn-success" data-toggle="modal" data-target="#newMemberModal"><i class="fa fa-user-o" aria-hidden="true"></i> Dodaj člana</button>
                                </div>
                                <div class="members-table-options text-right" ng-show="showCheckboxes">
                                    <button class="btn btn-primary pull-right" style="margin-left: 5px;" data-toggle="modal" data-target="#emailModal" >Napiši email</button>

                                    <select class="form-control pull-right" ng-model="newUserList.groupId" style="width:auto; display:inline; " ng-change="listGroupUsers(newUserList.groupId)">
                                        <option value="" disabled>---Odaberite grupu---</option>
                                        <option ng-repeat="group in eventGroups" ng-value="group.id">{{group.groupName}}</option>
                                    </select>
                                    <select class="form-control pull-right" ng-model="selectedEventID" style="width:auto; display:inline;" ng-change="listGroups(selectedEventID)">
                                        <option value="" disabled>---Odaberite događaj---</option>
                                        <option ng-repeat="event in avevents" ng-value="event.id">{{event.eventName}}</option>
                                    </select>
                                    <button class="btn btn-default pull-right" ng-click="filterActive=!filterActive;"><i class="fa fa-filter" aria-hidden="true"></i> Filteri</button>

                                    <button class="btn btn-default pull-left" ng-click="cancelPrepareEmail()">Odustani</button>

                                </div>
                            </div>
                        </div>
                        <!--<div class="box-members-list-wrap">
                            <ul id="top-members-pagination" uib-pagination total-items="filteredMembers.length - 1" items-per-page="pageSize" ng-model="currentPage" max-size="paginationSize" class="pagination-sm" boundary-link-numbers="true" previous-text="<<" next-text=">>"></ul>
                        </div>-->
                        <div class="table-responsive">
                            <table class="table members-table">
                                <thead>
                                    <tr>
                                        <th ng-if="showCheckboxes"><input type="checkbox" /></th>
                                        <th>Profil</th>
                                        <th ng-repeat="heading in headings" ng-click="sortMembersBy(heading)">
                                            {{heading.name}} <i class="fa fa-sort" aria-hidden="true"></i>
                                        </th>
                                        <th>Opcije</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!--<tr ng-repeat="member in members | filter : columnFilters |
                                        orderBy:propertyName:reverse | start: (currentPage-1) * pageSize | limitTo: pageSize">-->
                                    <tr ng-repeat="member in (filteredMembers = (members | filter : columnFilters)) |
                                        orderBy:propertyName:reverse | start: (currentPage-1) * pageSize | limitTo: pageSize">
                                        <td ng-if="showCheckboxes"><input type="checkbox" ng-model="member.checked" /></td>
                                        <td ng-if="member.gender === undefined"><img class="member-profile-picture" src="/img/mansilhouette.jpg" /></td>
                                        <td ng-if="member.gender === 'Musko'"><img class="member-profile-picture" src="/img/mansilhouette.jpg" /></td>
                                        <td ng-if="member.gender === 'Zensko'"><img class="member-profile-picture" src="/img/womansilhouette.jpg" /></td>
                                        <td>{{member.firstName}}</td>
                                        <td>{{member.lastName}}</td>
                                        <td>{{member.phoneNumber}}</td>
                                        <td>{{member.email}}</td>
                                        <td>{{member.address}}</td>
                                        <td>
                                            <a ng-href="#!/profile/{{member.userName}}"><i class="fa fa-user" aria-hidden="true"></i></a>
                                            <a ng-click="setEditMember(member.userName)" data-toggle="modal" data-target="#editMemberModal"><i class="fa fa-pencil" aria-hidden="true"></i></a>
                                            <a ng-click="setDeleteMember(member.userName)" data-toggle="modal" data-target="#deleteMemberModal"><i class="fa fa-ban" aria-hidden="true"></i></a>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <!--<div class="box-members-list-wrap">
                            <ul id="bottom-members-pagination" uib-pagination total-items="filteredMembers.length - 1" items-per-page="pageSize" ng-model="currentPage" max-size="paginationSize" class="pagination-sm" boundary-link-numbers="true" previous-text="<<" next-text=">>"></ul>
                        </div>-->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!--NEW MEMBER MODAL-->
<div id="newMemberModal" class="modal fade" role="dialog">
    <div class="modal-dialog modal-width-adjust">
        <!-- Modal content-->
        <div class="modal-content modal-width-adjust">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title modal-title-padding">Dodaj novog člana</h4>
            </div>
            <!--<div class="modal-body">-->
                

                <div class="add-member-form">
                    <div class="tab-content">
                        <div id="postani-clan-1" class="tab-pane fade in active">
                            <div class="login-line"><p>Korisnički podaci</p></div>
                            <input type="text" placeholder="Korisničko Ime"  required ng-model="newMember.userName"/>
                            <input type="password" placeholder="Šifra" required ng-model="newMember.password"/>
                            <input type="password" placeholder="Potvrdi Šifru" ng-model="newMember.confirmPassword"/>
                            <input type="text" placeholder="Ime" ng-model="newMember.firstName"/>
                            <input type="text" placeholder="Prezime" ng-model="newMember.lastName"/>
                            <input type="text" placeholder="Email" ng-model="newMember.email"/>

                            <button class="rectangle-btn login-btn-halfway no-bg-btn" data-dismiss="modal">Izađi</button><button class="rectangle-btn login-btn-halfway modal-border" data-toggle="tab" href="#postani-clan-2" target="_self">Dalje</button>
                        </div>
                        <div id="postani-clan-2" class="tab-pane fade">
                            <div class="login-line"><p>Lični podaci</p></div>
                            <div class="login-line" style="overflow:hidden;">
                                <div class="row" style="padding-top: 10px;">
                                    <div class="col-md-3"><label style="line-height:20px;">Datum Rođenja: </label></div>
                                    <div class="col-md-3">
                                        <select type="text" class="form-control" ng-model="dateOfBirth.day">
                                            <option ng-repeat="day in dateOfBirth.days" ng-value="day">{{day}}</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <select type="text" class="form-control" ng-model="dateOfBirth.month">
                                            <option ng-repeat="month in dateOfBirth.months" ng-value="month">{{month}}</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <select type="text" class="form-control" ng-model="dateOfBirth.year">
                                            <option ng-repeat="year in dateOfBirth.years" ng-value="year">{{year}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <input type="text" placeholder="Grad" ng-model="newMember.city" />
                            <input type="text" placeholder="Adresa" ng-model="newMember.address" />
                            <div class="login-line" style="overflow: hidden;">
                                <div class="row">
                                    <div class="col-md-2"><label>Telefon:</label></div>
                                    <div class="col-md-4" style="margin-top: 15px;">
                                        <select class="form-control" ng-model="selectedCountry">
                                            <option ng-repeat="country in countries" ng-value="country">{{country.name}} {{country.number}}</option>
                                        </select>
                                    </div>
                                    <div class="col-md-6"><input type="text" placeholder="Broj" ng-model="newMember.phoneNumber" /></div>
                                </div>
                            </div>
                            <fieldset id="genderRadio">
                                <ul class="login-line">
                                    <li><label>Spol: </label></li>
                                    <li><label class="radio-inline"><input type="radio" value="musko" ng-model="newMember.gender" name="genderRadio">Muško</label></li>
                                    <li><label class="radio-inline"><input type="radio" value="zensko" ng-model="newMember.gender" name="genderRadio">Žensko</label></li>
                                </ul>
                            </fieldset>
                            <fieldset id="employmentRadio">
                                <ul class="login-line">
                                    <li><label>Radni status: </label></li>
                                    <li><label class="radio-inline"><input type="radio" value="zaposlen" ng-model="newMember.employment" name="employmentRadio">Zaposlen/a</label></li>
                                    <li><label class="radio-inline"><input type="radio" value="nezaposlen" ng-model="newMember.employment" name="employmentRadio">Nezaposlen/a</label></li>
                                    <li><label class="radio-inline"><input type="radio" value="student" ng-model="newMember.employment" name="employmentRadio">Student</label></li>
                                </ul>
                            </fieldset>
                            <fieldset id="healthStatusRadio">
                                <ul class="login-line">
                                    <li><label>Nivo fizičke spreme: </label></li>
                                    <li><label class="radio-inline"><input type="radio" value="nizak" ng-model="newMember.healthStatus" name="healthStatusRadio">Nizak</label></li>
                                    <li><label class="radio-inline"><input type="radio" value="srednji" ng-model="newMember.healthStatus" name="healthStatusRadio">Srednji</label></li>
                                    <li><label class="radio-inline"><input type="radio" value="visok" ng-model="newMember.healthStatus" name="healthStatusRadio">Visok</label></li>
                                </ul>
                            </fieldset>
                            <button class="rectangle-btn login-btn-halfway no-bg-btn" data-toggle="tab" href="#postani-clan-1" target="_self">Nazad</button><button class="rectangle-btn login-btn-halfway modal-border"  data-toggle="tab" href="#postani-clan-3" target="_self">Dalje</button>
                        </div>
                        <div id="postani-clan-3" class="tab-pane fade">
                            <div class="login-line"><p>Odaberi svoje karakteristike (najmanje po jednu)</p></div>
                            <div class="text-center" ng-show="isloading()">
                                <img src="img/spin.gif" />
                            </div>
                            <div class="custom-accordion" id="accordion" ng-hide="isloading()">
                                <div class="panel panel-default" ng-repeat="category in interestCategories">
                                    <div class="panel-heading" data-toggle="collapse" data-parent="#accordion" ng-href="{{'#collapse' + $index}}" href="" target="_self">
                                        <h4 class="panel-title">
                                            <span>
                                                {{category.categoryName}}
                                            </span>
                                        </h4>
                                    </div>
                                    <div id="{{'collapse' + $index}}" class="panel-collapse collapse" ng-class='{in:$first}'>
                                        <div class="panel-body">
                                            <ul class="login-list">
                                                <li class="login-list-checkbox-label" ng-repeat="subCategory in subCategories" ng-click="toggleSelection(subCategory)" ng-if="subCategory.categoryId===category.id">
                                                    <label>{{subCategory.name}}</label>
                                                    <input type="checkbox" ng-checked="selected.indexOf(subCategory) > -1" />
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <button class="rectangle-btn login-btn-halfway no-bg-btn" data-toggle="tab" href="#postani-clan-2" target="_self">Nazad</button><button class="rectangle-btn login-btn-halfway" target="_self" ng-click="createMember()">Napravi Člana</button>
                        </div>
                    </div>
                </div>


                <!--</div>-->
            
        </div>

    </div>
</div>


<!--EDIT MEMBER MODAL-->
<div id="editMemberModal" class="modal fade" role="dialog">
    <div class="modal-dialog modal-width-adjust">
        <!-- Modal content-->
        <div class="modal-content modal-width-adjust">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title modal-title-padding">Izmijeni podatke člana: {{editingMember.userName}}</h4>
            </div>
            <div class="add-member-form">
                <div class="login-line"><p>Lični Podaci</p></div>
                <input type="text" placeholder="Ime" ng-model="editingMember.firstName" />
                <input type="text" placeholder="Prezime" ng-model="editingMember.lastName" />
                <input type="text" placeholder="Email" ng-model="editingMember.email" />
                <input type="text" placeholder="Telefon" ng-model="editingMember.phoneNumber" />
                <input type="text" placeholder="Grad" ng-model="editingMember.address" />
                <button class="rectangle-btn login-btn-halfway no-bg-btn" data-dismiss="modal" ng-click="cancelEdit()">Izađi</button><button class="rectangle-btn login-btn-halfway modal-border" style="background: #3A7AD2;" data-dismiss="modal" ng-click="updateMember()">Potvrdi izmjene</button>
            </div>
        </div>
    </div>
</div>


<!--DELETE MEMBER MODAL-->
<div id="deleteMemberModal" class="modal fade" role="dialog">
    <div class="modal-dialog modal-width-adjust">
        <!-- Modal content-->
        <div class="modal-content modal-width-adjust">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title modal-title-padding">Brisanje člana: {{deletingMember.userName}}</h4>
            </div>
            <div class="delete-member-form">
                <div class="login-line"><p id="del-question">Da li ste sigurni da želite obrisati člana?</p></div>
                <div class="login-line"><p>Ime: <strong>{{deletingMember.firstName}}</strong></p></div>
                <div class="login-line"><p>Prezime: <strong>{{deletingMember.lastName}}</strong></p></div>
                <div class="login-line"><p>Email: <strong>{{deletingMember.email}}</strong></p></div>
                <div class="login-line"><p>Telefon: <strong>{{deletingMember.phoneNumber}}</strong></p></div>
                <div class="login-line"><p>Grad: <strong>{{deletingMember.address}}</strong></p></div>
                <button class="rectangle-btn login-btn-halfway no-bg-btn" data-dismiss="modal" ng-click="cancelDelete()">Izađi</button><button class="rectangle-btn login-btn-halfway modal-border" style="background: #FF8235;" data-dismiss="modal" ng-click="deleteMember()">Izbriši Člana</button>
            </div>
        </div>
    </div>
</div>


<!--Email Modal-->
<div id="emailModal" class="modal fade" role="dialog" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-lg">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Slanje emaila</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <button class="btn btn-default" ng-click="getCurrentEvent()">Ubaci sadržaj događaja</button>
                </div>
                <div class="form-group"><label>Naslov emaila:</label><input class="form-control" type="text" ng-value="emailSubject" /></div>

                <text-angular ng-model="emailContent"></text-angular>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="sendEmail()">Pošalji</button>
                <button type="button" class="btn btn-default" data-dismiss="modal">Odustani</button>
            </div>
        </div>

    </div>
</div>